{"ast":null,"code":"// Import the functions you need from the SDKs you need\nimport { initializeApp } from 'firebase/app';\nimport { getFirestore, onSnapshot, Timestamp, setDoc, getDoc, doc } from 'firebase/firestore';\nimport { getAuth, onAuthStateChanged, GoogleAuthProvider, signInWithPopup, signOut } from 'firebase/auth'; // Your web app's Firebase configuration\n\nconst firebaseConfig = {\n  apiKey: 'AIzaSyBgOslrj6gg6djD4c5nTbk400Fo5faxcT4',\n  authDomain: 'crwn-db-48047.firebaseapp.com',\n  databaseURL: 'https://crwn-db-48047.firebaseio.com',\n  projectId: 'crwn-db-48047',\n  storageBucket: 'crwn-db-48047.appspot.com',\n  messagingSenderId: '120995028956',\n  appId: '1:120995028956:web:57b404d4044a67a1'\n}; // Initialize Firebase\n\nconst app = initializeApp(firebaseConfig);\nexport const auth = getAuth(app);\nexport const db = getFirestore(app);\nconst provider = new GoogleAuthProvider();\nprovider.setCustomParameters({\n  prompt: 'select_account'\n}); // Create new user doc in Frirestore\n\nexport const createUserProfileDocument = async function (userAuth) {\n  let additionalData = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  if (!userAuth) return;\n  console.log({\n    uid: userAuth.uid\n  });\n  const userDocRef = doc(db, 'users', `${userAuth.uid}`);\n  const userDocSnap = await getDoc(userDocRef);\n\n  if (!userDocSnap.exists()) {\n    const {\n      displayName,\n      email\n    } = userAuth;\n\n    try {\n      // Add a new doc to the users collection\n      await setDoc(doc(db, 'users'), {\n        displayName,\n        email,\n        createdAt: Timestamp.fromDate(new Date()),\n        ...additionalData\n      });\n    } catch (err) {\n      console.error('Error while creating a user', err.message);\n    }\n  }\n\n  return userDocRef;\n}; // Handle Suscription func\n\nconst handleSubscription = () => {\n  onAuthStateChanged(auth, async userAuth => {\n    if (userAuth) {\n      const userDocRef = await createUserProfileDocument(userAuth, {});\n\n      if (userDocRef) {\n        onSnapshot(userDocRef, doc => {\n          console.log('Doc form handleSubs', doc);\n        });\n      }\n    }\n  });\n}; // To use in SingInAndSingUp component\n\n\nexport const signInWithGoogle = () => signInWithPopup(auth, provider);\nexport const signOutUser = () => {\n  signOut(auth);\n};\nexport default {\n  db\n};","map":{"version":3,"sources":["/home/arnaldo/web-projects/portfolio/my-app/src/firebase/firebase.utils.tsx"],"names":["initializeApp","getFirestore","onSnapshot","Timestamp","setDoc","getDoc","doc","getAuth","onAuthStateChanged","GoogleAuthProvider","signInWithPopup","signOut","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","app","auth","db","provider","setCustomParameters","prompt","createUserProfileDocument","userAuth","additionalData","console","log","uid","userDocRef","userDocSnap","exists","displayName","email","createdAt","fromDate","Date","err","error","message","handleSubscription","signInWithGoogle","signOutUser"],"mappings":"AAAA;AACA,SAAwBA,aAAxB,QAA6C,cAA7C;AACA,SACEC,YADF,EAEEC,UAFF,EAGEC,SAHF,EAMEC,MANF,EAOEC,MAPF,EAQEC,GARF,QAUO,oBAVP;AAWA,SACEC,OADF,EAEEC,kBAFF,EAGEC,kBAHF,EAIEC,eAJF,EAKEC,OALF,QAOO,eAPP,C,CASA;;AACA,MAAMC,cAAc,GAAG;AACrBC,EAAAA,MAAM,EAAE,yCADa;AAErBC,EAAAA,UAAU,EAAE,+BAFS;AAGrBC,EAAAA,WAAW,EAAE,sCAHQ;AAIrBC,EAAAA,SAAS,EAAE,eAJU;AAKrBC,EAAAA,aAAa,EAAE,2BALM;AAMrBC,EAAAA,iBAAiB,EAAE,cANE;AAOrBC,EAAAA,KAAK,EAAE;AAPc,CAAvB,C,CAUA;;AACA,MAAMC,GAAG,GAAGpB,aAAa,CAACY,cAAD,CAAzB;AACA,OAAO,MAAMS,IAAI,GAAGd,OAAO,CAACa,GAAD,CAApB;AACP,OAAO,MAAME,EAAE,GAAGrB,YAAY,CAACmB,GAAD,CAAvB;AAEP,MAAMG,QAAQ,GAAG,IAAId,kBAAJ,EAAjB;AACAc,QAAQ,CAACC,mBAAT,CAA6B;AAAEC,EAAAA,MAAM,EAAE;AAAV,CAA7B,E,CAEA;;AACA,OAAO,MAAMC,yBAAyB,GAAG,gBACvCC,QADuC,EAGpC;AAAA,MADHC,cACG,uEADc,EACd;AACH,MAAI,CAACD,QAAL,EAAe;AACfE,EAAAA,OAAO,CAACC,GAAR,CAAY;AAAEC,IAAAA,GAAG,EAAEJ,QAAQ,CAACI;AAAhB,GAAZ;AACA,QAAMC,UAAU,GAAG1B,GAAG,CAACgB,EAAD,EAAK,OAAL,EAAe,GAAEK,QAAQ,CAACI,GAAI,EAA9B,CAAtB;AACA,QAAME,WAAW,GAAG,MAAM5B,MAAM,CAAC2B,UAAD,CAAhC;;AAEA,MAAI,CAACC,WAAW,CAACC,MAAZ,EAAL,EAA2B;AACzB,UAAM;AAAEC,MAAAA,WAAF;AAAeC,MAAAA;AAAf,QAAyBT,QAA/B;;AACA,QAAI;AACF;AACA,YAAMvB,MAAM,CAACE,GAAG,CAACgB,EAAD,EAAK,OAAL,CAAJ,EAAmB;AAC7Ba,QAAAA,WAD6B;AAE7BC,QAAAA,KAF6B;AAG7BC,QAAAA,SAAS,EAAElC,SAAS,CAACmC,QAAV,CAAmB,IAAIC,IAAJ,EAAnB,CAHkB;AAI7B,WAAGX;AAJ0B,OAAnB,CAAZ;AAMD,KARD,CAQE,OAAOY,GAAP,EAAiB;AACjBX,MAAAA,OAAO,CAACY,KAAR,CAAc,6BAAd,EAA6CD,GAAG,CAACE,OAAjD;AACD;AACF;;AAED,SAAOV,UAAP;AACD,CAzBM,C,CA2BP;;AACA,MAAMW,kBAAkB,GAAG,MAAM;AAC/BnC,EAAAA,kBAAkB,CAACa,IAAD,EAAO,MAAOM,QAAP,IAAoB;AAC3C,QAAIA,QAAJ,EAAc;AACZ,YAAMK,UAAU,GAAG,MAAMN,yBAAyB,CAACC,QAAD,EAAW,EAAX,CAAlD;;AAEA,UAAIK,UAAJ,EAAgB;AACd9B,QAAAA,UAAU,CAAC8B,UAAD,EAAc1B,GAAD,IAAS;AAC9BuB,UAAAA,OAAO,CAACC,GAAR,CAAY,qBAAZ,EAAmCxB,GAAnC;AACD,SAFS,CAAV;AAGD;AACF;AACF,GAViB,CAAlB;AAWD,CAZD,C,CAcA;;;AACA,OAAO,MAAMsC,gBAAgB,GAAG,MAAMlC,eAAe,CAACW,IAAD,EAAOE,QAAP,CAA9C;AACP,OAAO,MAAMsB,WAAW,GAAG,MAAM;AAC/BlC,EAAAA,OAAO,CAACU,IAAD,CAAP;AACD,CAFM;AAIP,eAAe;AAAEC,EAAAA;AAAF,CAAf","sourcesContent":["// Import the functions you need from the SDKs you need\nimport { FirebaseError, initializeApp } from 'firebase/app';\nimport {\n  getFirestore,\n  onSnapshot,\n  Timestamp,\n  collection,\n  getDocs,\n  setDoc,\n  getDoc,\n  doc,\n  FirestoreError,\n} from 'firebase/firestore';\nimport {\n  getAuth,\n  onAuthStateChanged,\n  GoogleAuthProvider,\n  signInWithPopup,\n  signOut,\n  User,\n} from 'firebase/auth';\n\n// Your web app's Firebase configuration\nconst firebaseConfig = {\n  apiKey: 'AIzaSyBgOslrj6gg6djD4c5nTbk400Fo5faxcT4',\n  authDomain: 'crwn-db-48047.firebaseapp.com',\n  databaseURL: 'https://crwn-db-48047.firebaseio.com',\n  projectId: 'crwn-db-48047',\n  storageBucket: 'crwn-db-48047.appspot.com',\n  messagingSenderId: '120995028956',\n  appId: '1:120995028956:web:57b404d4044a67a1',\n};\n\n// Initialize Firebase\nconst app = initializeApp(firebaseConfig);\nexport const auth = getAuth(app);\nexport const db = getFirestore(app);\n\nconst provider = new GoogleAuthProvider();\nprovider.setCustomParameters({ prompt: 'select_account' });\n\n// Create new user doc in Frirestore\nexport const createUserProfileDocument = async (\n  userAuth: User,\n  additionalData = {}\n) => {\n  if (!userAuth) return;\n  console.log({ uid: userAuth.uid });\n  const userDocRef = doc(db, 'users', `${userAuth.uid}`);\n  const userDocSnap = await getDoc(userDocRef);\n\n  if (!userDocSnap.exists()) {\n    const { displayName, email } = userAuth;\n    try {\n      // Add a new doc to the users collection\n      await setDoc(doc(db, 'users'), {\n        displayName,\n        email,\n        createdAt: Timestamp.fromDate(new Date()),\n        ...additionalData,\n      });\n    } catch (err: any) {\n      console.error('Error while creating a user', err.message);\n    }\n  }\n\n  return userDocRef;\n};\n\n// Handle Suscription func\nconst handleSubscription = () => {\n  onAuthStateChanged(auth, async (userAuth) => {\n    if (userAuth) {\n      const userDocRef = await createUserProfileDocument(userAuth, {});\n\n      if (userDocRef) {\n        onSnapshot(userDocRef, (doc) => {\n          console.log('Doc form handleSubs', doc);\n        });\n      }\n    }\n  });\n};\n\n// To use in SingInAndSingUp component\nexport const signInWithGoogle = () => signInWithPopup(auth, provider);\nexport const signOutUser = () => {\n  signOut(auth);\n};\n\nexport default { db };\n"]},"metadata":{},"sourceType":"module"}